openapi: '3.0.2'
info:
  title: SI-EMOO
  description: This is a sample SI-EMOO server.
  version: '1.0.0'
servers:
  - url: https://siemoo.vercel.app/api/v1
    description: Development server
  - url: http://localhost:3000/api/v1
    description: local server
paths:
  # user
  /user/register:
    post:
      tags:
        - User
      summary: Register user
      description: Register user
      operationId: register
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  default: "mail@mail.com"
                password:
                  type: string
                  default: "**********"
                fullname:
                  type: string
                  default: "Fatkhurrohman Purnomo"
                sapi:
                  type: integer
                  default: 1
                no_wa:
                  type: string
                  default: "085151515151"
                rt:
                  type: string
                  default: "01"
                rw: 
                  type: string
                  default: "01"
                id_kelompok:
                  type: integer
                  default: 01
                role:
                  type: string
                  default: "pembeli"
      responses:
        '201':
          description: OK!
        '404':
          description: Bad Request
  
  /user/login:
    post:
      tags:
        - User
      summary: Login user
      description: Login user
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  default: "mail@mail.com"
                password:
                  type: string
                  default: "**********"
      responses:
        '201':
          description: OK!
        '404':
          description: Bad Request
  /user/whoami:
    get:
      tags:
        - User
      summary: Data user
      description: Data user
      operationId: getUlasan
      security:
        - bearerAuth: []
      responses:
        "200":
          description: OK!
        '400':
          description: Invalid status value

  # user
  /kelompok:
    post:
      tags:
        - Kelompok
      summary: Menambahkan kelompok tani
      description: Menambahkan kelompok tani
      operationId: create-kelompok
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nama:
                  type: string
                  default: "Kelompok maju tani"
      responses:
        '201':
          description: Kelompok created successfully
        '404':
          description: Bad Request
      security:
        - bearerAuth: []

    get:
      tags:
        - Kelompok
      summary: Mendapatkan kelompok
      description: Mendapatkan semua kelompok
      operationId: getKelompok
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/BasicResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 2
                          nama:
                            type: string
                            example: "ads"
        '400':
          description: Bad Request!


  /kelompok/{id}:
    get:
      tags:
        - Kelompok
      summary: Mendapatkan kelompok
      description: Mendapatkan kelompok sesuai id
      operationId: getkelompokById
      parameters:
        - name: id
          in: path
          required: true
          description: Get Kelompok By Id
          schema:
            type : integer
            format: int64
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/BasicResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 2
                          nama:
                            type: string
                            example: "ads"
                          created:
                            type: string
                            example: "2023-12-28T14:18:05.000Z"
                          updated:
                            type: string
                            example: "2023-12-28T14:18:05.000Z"

        '400':
          description: Bad Request!

    put:
      tags:
        - Kelompok
      summary: Mengedit Kelompok 
      description: Mengedit kelompok sesuai id
      operationId: update-kelompok
      parameters:
        - name: id
          in: path
          required: true
          description: Get Kelompok By Id
          schema:
            type : integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nama:
                  type: string
                  default: "Kelompok maju tani"
      responses:
        '200':
          description: OK!
        '400':
          description: Bad Request!
      security:
        - bearerAuth: []

    delete:
      tags:
        - Kelompok
      summary: Menghapus kelompok 
      description: Menghapus kelompok sesuai id
      operationId: delete-kelompok
      parameters:
        - name: id
          in: path
          required: true
          description: Get Kelompok By Id
          schema:
            type : integer
            format: int64
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/BasicResponse"
                  - type: object
                    properties:
                      data:
                        type: string
                        example: null
                        

        '400':
          description: Bad Request!
      security:
        - bearerAuth: []

  # Artikel
  /artikel:
    post:
      tags:
        - Artikel
      summary: Menambahkan artikel
      description: Menambahkan artikel baik untuk menu Olah pangan atau Sulap limbah (link dan gambar bisa tidak di isi, atau di isi keduanya)
      operationId: create-artikel
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                judul:
                  type: string
                  default: "Judul artikel"
                deskripsi: 
                  type: string
                  default: "Sapi adalah hewan"
                menu:
                  type: string
                  description: pilih salah satu (olah_pangan / olah_pangan)
                image:
                  type: string
                  format: binary
                  description: Dapat memasukkan lebih dari 1 gambar
                link:
                  type: string
                  default: "https://youtube.com"
                  description: dapat memasukan link video atau foto. hanya dapat memasukan 1 link
                
      responses:
        '201':
          description: Artikel created successfully
        '404':
          description: Bad Request
      security:
        - bearerAuth: []

  /artikel/limbah:
    get:
      tags:
        - Artikel
      summary: Mendapatkan artikel limbah
      description: Mendapatkan semua artikel limbah
      operationId: get-artikel-limbah
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/BasicResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          allOf:
                            - $ref: "#/components/schemas/Artikel"
                            - type: object
                              properties:
                                menu:
                                  type: string
                                  example: "sulap_limbah"
                                media:
                                  $ref: "#/components/schemas/Media"
        '400':
          description: Bad Request!   

  /artikel/pangan:
    get:
      tags:
        - Artikel
      summary: Mendapatkan artikel pangan
      description: Mendapatkan semua artikel pangan
      operationId: get-artikel-pangan
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/BasicResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          allOf:
                            - $ref: "#/components/schemas/Artikel"
                            - type: object
                              properties:
                                menu:
                                  type: string
                                  example: "olah_pangan"
                                media:
                                  $ref: "#/components/schemas/Media"
        '400':
          description: Bad Request!    

  /artikel/{id}:
    get:
      tags:
        - Artikel
      summary: Mendapatkan artikel
      description: Mendapatkan artikel sesuai id
      operationId: get-artikel-by-id
      parameters:
        - name: id
          in: path
          required: true
          description: Get Artikel By Id
          schema:
            type : integer
            format: int64
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/BasicResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 1
                          id_user:
                            type: integer
                            example: 2
                          judul:
                            type: string
                            example: "Sapi racing"
                          deskripsi:
                            type: string
                            example: "Makanan sapi"
                          menu: 
                            type: string
                            example: "sulap_limbah"
                          created:
                            type: string
                            example: "2023-12-28T14:18:05.000Z"
                          updated:
                            type: string
                            example: "2023-12-28T14:18:05.000Z"
                          user:
                            type: object
                            properties:
                              fullname:
                                type: string
                              created:
                                type: string
                                example: "2023-12-28T14:18:05.000Z"
                              updated:
                                type: string
                                example: "2023-12-28T14:18:05.000Z"
                          media: 
                            $ref: "#/components/schemas/MediaFull"
                              

        '400':
          description: Bad Request!

    put:
      tags:
        - Artikel
      summary: Update artikel
      description: Update artikel baik untuk menu Olah pangan atau Sulap limbah (link dan gambar bisa tidak di isi, atau di isi keduanya)
      operationId: update-artikel
      parameters:
        - name: id
          in: path
          required: true
          description: Get Artikel By Id
          schema:
            type : integer
            format: int64
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                judul:
                  type: string
                  default: "Judul artikel"
                deskripsi: 
                  type: string
                  default: "Sapi adalah hewan"
                menu:
                  type: string
                  description: pilih salah satu (olah_pangan / olah_pangan)
                image:
                  type: string
                  format: binary
                  description: Dapat memasukkan lebih dari 1 gambar
                link:
                  type: string
                  default: "https://youtube.com"
                  description: dapat memasukan link video atau foto. hanya dapat memasukan 1 link
                
      responses:
        '201':
          description: Artikel created successfully
        '404':
          description: Bad Request
      security:
        - bearerAuth: []
    
    delete:
      tags:
        - Artikel
      summary: Menghapus artikel 
      description: Menghapus artikel sesuai id
      operationId: delete-artikel
      parameters:
        - name: id
          in: path
          required: true
          description: Get Artikel By Id
          schema:
            type : integer
            format: int64
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/BasicResponse"
                  - type: object
                    properties:
                      data:
                        type: string
                        example: null
                        

        '400':
          description: Bad Request!
      security:
        - bearerAuth: []


  # # ulasan
  # /user/registesadr:
  #   get:
  #     tags:
  #       - Ulasan
  #     summary: Mendapatkan ulasan
  #     description: Mendapatkan semua ulasan
  #     operationId: registeras
  #     parameters:
  #       - name: page
  #         in: query
  #         description: Get users by page
  #         schema:
  #           type : integer
  #           format: int64
  #           minimum: 1
  #       - name: limit
  #         in: query
  #         description: Get users by limit
  #         schema:
  #           type : integer
  #           format: int64
  #           minimum: 1
  #     responses:
  #       "200":
  #         description: Successful operation
  #         content:
  #           application/json:
  #             schema:
  #               allOf:
  #                 - $ref: "#/components/schemas/BasicResponse"
  #                 - type: object
  #                   properties:
  #                     data:
  #                       type: array
  #                       items:
  #                         type: object
  #                         properties:
  #                           id:
  #                             type: integer
  #                             example: 2
  #                           nama:
  #                             type: string
  #                             example: "ads"
  #                           ulasan:
  #                             type: string
  #                             example: "apa adanya"
  #                           wisataId:
  #                             type: integer
  #                             example: 20
  #                           hotelId:
  #                             type: string
  #                             example: null
  #                           createdAt:
  #                             type: string
  #                             format: date-time
  #                             example: "2023-11-26T07:42:08.186Z"
  #                           updatedAt:
  #                             type: string
  #                             format: date-time
  #                             example: "2023-11-26T07:42:08.186Z"
  #                           wisata:
  #                             type: string
  #                             example: "The Westin Singapore"
  
  # /ulasan/{id}:
  #   get:
  #     tags:
  #       - Ulasan
  #     summary: Mendapatkan ulasan
  #     description: Mendapatkan ulasan sesuai id
  #     operationId: getUlasanById
  #     parameters:
  #       - name: id
  #         in: path
  #         required: true
  #         description: Get Ulasan By Id
  #         schema:
  #           type : integer
  #           format: int64
  #     responses:
  #       "200":
  #         description: Successful operation
  #         content:
  #           application/json:
  #             schema:
  #               type: object
  #               properties:
  #                 status:
  #                   type: boolean
  #                   example: true
  #                 message:
  #                   type: string
  #                   example: "OK"
  #                 err:
  #                   type: object
  #                   example: null
  #                 data:
  #                   type: object
  #                   properties:
  #                     id:
  #                       type: integer
  #                       example: 2
  #                     nama:
  #                       type: string
  #                       example: "ads"
  #                     ulasan:
  #                       type: string
  #                       example: "apa adanya"
  #                     wisataId:
  #                       type: integer
  #                       example: 20
  #                     hotelId:
  #                       type: string
  #                       example: null
  #                     createdAt:
  #                       type: string
  #                       format: date-time
  #                       example: "2023-11-26T07:42:08.186Z"
  #                     updatedAt:
  #                       type: string
  #                       format: date-time
  #                       example: "2023-11-26T07:42:08.186Z"
  #                     wisata:
  #                       type: string
  #                       example: "The Westin Singapore"
  #       '400':
  #         description: Invalid status value
    
  #   post:
  #     tags:
  #       - Ulasan
  #     summary: Menambahkan ulasan 
  #     description: Menambahkan ulasan di wisata atau di hotel sesuai id
  #     operationId: create-ulasan
  #     requestBody:
  #       required: true
  #       content:
  #         multipart/form-data:
  #           schema:
  #             type: object
  #             properties:
  #               nama:
  #                 type: string
  #                 default: "ads"
  #               ulasan:
  #                 type: string
  #                 default: "apa adanya"
  #               wisataId:
  #                 type: integer
  #                 default: 20
  #               hotelId:
  #                 type: string
  #                 default: null
  #     responses:
  #       '201':
  #         description: OK!
  #       '400':
  #         description: Invalid status value
    
  #   put:
  #     tags:
  #       - Ulasan
  #     summary: Mengedit ulasan 
  #     description: Mengedit ulasan sesuai id
  #     operationId: update-ulasan
  #     parameters:
  #       - name: id
  #         in: path
  #         required: true
  #         description: Get Ulasan By Id
  #         schema:
  #           type : integer
  #           format: int64
  #     requestBody:
  #       required: true
  #       content:
  #         multipart/form-data:
  #           schema:
  #             type: object
  #             properties:
  #               nama:
  #                 type: string
  #                 default: "ads"
  #               ulasan:
  #                 type: string
  #                 default: "apa adanya"
  #               wisataId:
  #                 type: integer
  #                 default: 20
  #               hotelId:
  #                 type: string
  #                 default: null
  #     responses:
  #       '201':
  #         description: OK!
  #       '400':
  #         description: Invalid status value
    
  #   delete:
  #     tags:
  #       - Ulasan
  #     summary: Menghapus ulasan
  #     description: Menghapus ulasan sesuai id
  #     operationId: deleteUlasanById
  #     parameters:
  #       - name: id
  #         in: path
  #         required: true
  #         description: Get Ulasan By Id
  #         schema:
  #           type : integer
  #           format: int64
  #     responses:
  #       "200":
  #         description: Successful operation
  #         content:
  #           application/json:
  #             schema:
  #               type: object
  #               properties:
  #                 status:
  #                   type: boolean
  #                   example: true
  #                 message:
  #                   type: string
  #                   example: "Data ulasan berhasil dihapus"
  #                 err:
  #                   type: string
  #                   example: null
  #                 data:
  #                   type: object
  #                   example: null
  #       '400':
  #         description: Invalid status value
  #     security:
  #       - bearerAuth: []
        

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    BasicResponse:
        title: BasicResponse
        type: object
        properties:
          status:
            type: boolean
            example: true
          message:
            type: string
            example: "OK"
          err:
            type: object
            example: null
    Pagination:
      title: Pagination
      type: object
      properties:
        links:
          type: object
          properties:
            next:
              type: string
              example: "https://domain.com/users?page=3&limit=10"
            prev:
              type: string
              example: "https://domain.com/users?page=1&limit=10"
        total_items:
          type: integer
          example: 100
    Data:
      title: Data
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: "John Doe"
        email:
          type: string
          example: "mail@mail.com"

    Artikel:
      title: artikel
      type: object
      properties:
        id:
          type: integer
          example: 2
        nama:
          type: string
          example: "ads"
        judul:
          type: string
          example: "Sapi muda"
        deskripsi:
          type: string
          example: "Sapi merupakan hewan"

    Media:
      title: media
      type: array
      items: 
        type: object
        properties:
          id:
            type: integer
            example: 1
          link: 
            type: string
            example: "https://ik.imagekit.io/fathpurn/"
    
    Waktu:
      title: waktu
      properties:
        created:
          type: string
          example: "2023-12-28T14:18:05.000Z"
        updated:
          type: string
          example: "2023-12-28T14:18:05.000Z"
    

    MediaFull:
      title: media-full
      type: array
      items:
        type: object
        properties:
          id:
            type: integer
            example: 44
          id_artikel:
            type: integer
            example: 16
          id_warung:
            type: integer
            example: 1
          id_link:
            type: string
            example: "658efb4688c257da337cec86"
          link:
            type: string
            example: "https://ik.imagekit.io/fathpurn/"
          created:
            type: string
            format: date-time
            example: "2023-12-29T17:00:55.471Z"
          updated:
            type: string
            format: date-time
            example: "2023-12-29T17:00:55.471Z"
